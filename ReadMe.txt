Добрый день. 
Прошу прощения, утром скинул нерабочую версию, без капта, сейчас доделал, добавил room. 
Если возможно прошу рассмотреть эту версию.